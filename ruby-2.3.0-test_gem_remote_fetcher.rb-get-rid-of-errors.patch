From d000290a675745d9fb8a4658b8b5922f6a734522 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?V=C3=ADt=20Ondruch?= <vondruch@redhat.com>
Date: Tue, 16 Jun 2015 08:22:47 +0200
Subject: [PATCH] Increase DH key size (fixes #1289).

This fixes compatibility with OpenSLL 1.0.2c+:

https://www.openssl.org/blog/blog/2015/05/20/logjam-freak-upcoming-changes/
---
 test/rubygems/test_gem_remote_fetcher.rb | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/test/rubygems/test_gem_remote_fetcher.rb b/test/rubygems/test_gem_remote_fetcher.rb
index 6b29e18..c318870 100644
--- a/test/rubygems/test_gem_remote_fetcher.rb
+++ b/test/rubygems/test_gem_remote_fetcher.rb
@@ -898,7 +898,7 @@ def start_ssl_server(config = {})
       server.mount_proc("/insecure_redirect") { |req, res|
         res.set_redirect(WEBrick::HTTPStatus::MovedPermanently, req.query['to'])
       }
-      server.ssl_context.tmp_dh_callback = proc { OpenSSL::PKey::DH.new 128 }
+      server.ssl_context.tmp_dh_callback = proc { OpenSSL::PKey::DH.new 2048 }
       t = Thread.new do
         begin
           server.start
